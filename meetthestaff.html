<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meet the Staff | British Hills Summer Camp</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Cinzel:wght@400;700&family=Patrick+Hand&display=swap" rel="stylesheet">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cream: '#fdfbf7',
                        hunter: '#234f32',
                        'hunter-dark': '#1a3b25',
                        gold: '#c5a009',
                        danger: '#ef4444',
                    },
                    fontFamily: {
                        header: ['Cinzel', 'serif'],
                        body: ['Patrick Hand', 'cursive'],
                        accent: ['Architects Daughter', 'cursive'],
                    },
                    boxShadow: {
                        'paper': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fdfbf7;
            background-image: radial-gradient(#c5a009 0.5px, transparent 0.5px);
            background-size: 20px 20px;
        }
        
        /* Smooth row hover */
        .contact-row {
            transition: all 0.2s ease;
        }
        .contact-row:hover {
            background-color: white;
            transform: translateX(4px);
        }

        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #fdfbf7; 
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #c5a009; 
            border-radius: 4px;
        }

        /* SVG Icon animation */
        .call-btn:hover svg {
            transform: scale(1.1) rotate(-10deg);
            color: #c5a009;
        }

        /* Mic Button Active State */
        .mic-listening {
            background-color: #ef4444 !important; /* Red */
            color: white !important;
            animation: pulse 1.5s infinite;
            border-color: #ef4444 !important;
        }
    </style>
</head>
<body class="text-hunter font-body min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-hunter text-cream py-6 border-b-4 border-gold shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-12 md:px-4 text-center relative">
            <a href="index.html" class="absolute left-2 md:left-0 top-1/2 -translate-y-1/2 bg-cream/70 backdrop-blur-sm text-hunter hover:bg-white px-3 py-2 md:px-4 md:py-2 rounded-full font-header font-bold shadow-md flex items-center gap-2 transition-all hover:scale-105 text-sm md:text-base border border-transparent hover:border-gold z-50">
                <span>&larr;</span> <span class="hidden sm:inline">Home</span>
            </a>

            <h1 class="text-3xl md:text-5xl font-header font-bold tracking-wider">Meet the Team</h1>
            <p class="font-accent text-lg md:text-xl text-gold mt-2 leading-tight">There are many staff at British Hills from all over the world.<br>Give some of them a call and have a chat!</p>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 max-w-3xl">

        <!-- CONTACT LIST VIEW -->
        <div id="gallery-view" class="transition-opacity duration-500 ease-in-out">
            <div class="bg-white/30 backdrop-blur-sm rounded-2xl border-2 border-hunter/10 overflow-hidden shadow-paper" id="staff-grid">
                <!-- Contact rows will be injected here via JS -->
            </div>
        </div>

        <!-- VIDEO CHAT INTERFACE (MODAL) -->
        <div id="chat-view" class="hidden fixed inset-0 bg-hunter/90 z-50 flex items-center justify-center p-4">
            <div class="bg-cream rounded-xl shadow-2xl w-full max-w-5xl h-[90vh] md:h-[80vh] flex flex-col md:flex-row overflow-hidden border-4 border-gold relative">
                <button onclick="closeChat()" class="absolute top-4 left-4 z-20 bg-white/80 hover:bg-white text-hunter px-4 py-2 rounded-full font-header font-bold shadow-md flex items-center gap-2 transition-colors text-sm md:text-base">
                    <span>&larr;</span> Back
                </button>

                <!-- Left Column: Video -->
                <div class="w-full md:w-2/3 h-[35vh] md:h-auto bg-hunter-dark relative flex items-center justify-center group shrink-0">
                    <video id="main-video" class="w-full h-full object-contain md:object-cover" controls playsinline controlsList="nodownload" oncontextmenu="return false;">
                        <source src="" type="video/mp4">
                    </video>
                </div>

                <!-- Right Column: Interaction -->
                <div class="w-full md:w-1/3 flex-1 flex flex-col bg-cream border-l-0 md:border-l-4 border-gold min-h-0">
                    <div class="p-4 md:p-6 border-b-2 border-hunter/20 bg-white shrink-0">
                        <h2 id="chat-staff-name" class="text-2xl md:text-4xl font-header font-bold text-hunter">Staff Name</h2>
                        <p id="chat-staff-role" class="text-lg md:text-xl font-accent text-gold-dark mt-1">Role</p>
                    </div>

                    <div class="flex-grow p-4 md:p-6 flex flex-col gap-3 md:gap-4 overflow-y-auto custom-scroll bg-cream">
                        
                        <!-- Voice Interaction Section -->
                        <div class="bg-white border-2 border-hunter/10 rounded-lg p-3 mb-2 flex flex-col items-center text-center shadow-sm">
                            <button id="mic-btn" class="w-14 h-14 rounded-full bg-hunter text-cream flex items-center justify-center shadow-md transition-all hover:scale-105 border-2 border-gold/50 mb-2">
                                <!-- Mic Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                                </svg>
                            </button>
                            <p id="speech-feedback" class="text-sm font-body text-hunter/70 leading-tight min-h-[1.25rem]">
                                Click mic to ask a question
                            </p>
                        </div>

                        <p class="font-body text-base md:text-lg text-hunter/80 mb-1">Or click a question:</p>
                        <div id="question-buttons" class="flex flex-col gap-2 md:gap-3 pb-4">
                        </div>
                    </div>

                    <div class="p-3 md:p-4 bg-hunter/10 text-center text-xs md:text-sm font-accent text-hunter shrink-0">
                        British Hills Summer Camp
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-hunter text-cream py-8 mt-8 border-t-4 border-gold">
        <div class="container mx-auto px-4 text-center font-header">
            <p>&copy; 2024 British Hills. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        const staffData = [
            {
                id: "james",
                name: "James",
                role: "Guest Services",
                image: "assets/meetthestaffvids/james.jpg",
                introVideo: "assets/meetthestaffvids/james_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/james_q1.mp4" },
                    { text: "What do you like about Japan?", video: "assets/meetthestaffvids/james_q2.mp4" },
                    { text: "What should I do if I need help?", video: "assets/meetthestaffvids/james_q3.mp4" }
                ]
            },
            {
                id: "ben",
                name: "Ben",
                role: "Teacher",
                image: "assets/meetthestaffvids/ben.jpg",
                introVideo: "assets/meetthestaffvids/ben_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/ben_q1.mp4" },
                    { text: "What's your favourite TV show?", video: "assets/meetthestaffvids/ben_q2.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/ben_q3.mp4" }
                ]
            },
            {
                id: "takako",
                name: "Takako",
                role: "Attendant",
                image: "assets/meetthestaffvids/takako.jpg",
                introVideo: "assets/meetthestaffvids/takako_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/takako_q1.mp4" },
                    { text: "How did you learn English?", video: "assets/meetthestaffvids/takako_q2.mp4" },
                    { text: "What is your favourite season?", video: "assets/meetthestaffvids/takako_q3.mp4" }
                ]
            },
            {
                id: "marcus",
                name: "Marcus",
                role: "Teacher",
                image: "assets/meetthestaffvids/marcus.jpg", 
                introVideo: "assets/meetthestaffvids/marcus_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/marcus_q1.mp4" },
                    { text: "What is your favourite place in Japan?", video: "assets/meetthestaffvids/marcus_q2.mp4" },
                    { text: "What's your favourite food?", video: "assets/meetthestaffvids/marcus_q3.mp4" }
                ]
            },
            {
                id: "santi",
                name: "Santi",
                role: "Guest Services",
                image: "assets/meetthestaffvids/santi.jpg",
                introVideo: "assets/meetthestaffvids/santi_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/santi_q1.mp4" },
                    { text: "What football team do you support?", video: "assets/meetthestaffvids/santi_q2.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/santi_q3.mp4" }
                ]
            },
            {
                id: "donovan",
                name: "Donovan",
                role: "Teacher",
                image: "assets/meetthestaffvids/donovan.jpg",
                introVideo: "assets/meetthestaffvids/donovan_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/donovan_q1.mp4" },
                    { text: "What is your favourite place in Japan?", video: "assets/meetthestaffvids/donovan_q2.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/donovan_q3.mp4" }
                ]
            },
            {
                id: "luke",
                name: "Luke",
                role: "Teacher",
                image: "assets/meetthestaffvids/luke.jpg",
                introVideo: "assets/meetthestaffvids/luke_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/luke_q1.mp4" },
                    { text: "What is your favourite British Hills Lesson?", video: "assets/meetthestaffvids/luke_q2.mp4" },
                    { text: "What season do you like?", video: "assets/meetthestaffvids/luke_q3.mp4" }
                ]
            },
            {
                id: "chantelle",
                name: "Chantelle",
                role: "Teacher",
                image: "assets/meetthestaffvids/chantelle.jpg",
                introVideo: "assets/meetthestaffvids/chantelle_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/chantelle_q1.mp4" },
                    { text: "What's your favourite place in Japan?", video: "assets/meetthestaffvids/chantelle_q2.mp4" },
                    { text: "What are you afraid of?", video: "assets/meetthestaffvids/chantelle_q3.mp4" }
                ]
            },
            {
                id: "kanon",
                name: "Kanon",
                role: "Attendant",
                image: "assets/meetthestaffvids/kanon.jpg",
                introVideo: "assets/meetthestaffvids/kanon_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/kanon_q1.mp4" },
                    { text: "What are you afraid of?", video: "assets/meetthestaffvids/kanon_q2.mp4" },
                    { text: "Have you studied abroad?", video: "assets/meetthestaffvids/kanon_q3.mp4" }
                ]
            },
            {
                id: "shavaughn",
                name: "Shavaughn",
                role: "Teacher",
                image: "assets/meetthestaffvids/shavaughn.jpg",
                introVideo: "assets/meetthestaffvids/shavaughn_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/shavaughn_q1.mp4" },
                    { text: "Why did you come to Japan?", video: "assets/meetthestaffvids/shavaughn_q2.mp4" },
                    { text: "What music do you like?", video: "assets/meetthestaffvids/shavaughn_q3.mp4" }
                ]
            },
            {
                id: "kimberley",
                name: "Kimberley",
                role: "Teacher",
                image: "assets/meetthestaffvids/kimberley.jpg",
                introVideo: "assets/meetthestaffvids/kimberley_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/kimberley_q1.mp4" },
                    { text: "Why did you come to Japan?", video: "assets/meetthestaffvids/kimberley_q2.mp4" },
                    { text: "What is your favourite place in Japan?", video: "assets/meetthestaffvids/kimberley_q3.mp4" }
                ]
            },
            {
                id: "tom",
                name: "Tom",
                role: "Teacher",
                image: "assets/meetthestaffvids/tom.jpg",
                introVideo: "assets/meetthestaffvids/tom_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/tom_q1.mp4" },
                    { text: "What's your hobby?", video: "assets/meetthestaffvids/tom_q2.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/tom_q3.mp4" }
                ]
            },
            {
                id: "zain",
                name: "Zain",
                role: "Teacher",
                image: "assets/meetthestaffvids/zain.jpg",
                introVideo: "assets/meetthestaffvids/zain_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/zain_q1.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/zain_q2.mp4" },
                    { text: "What's your favourite lesson at British Hills?", video: "assets/meetthestaffvids/zain_q3.mp4" }
                ]
            },
            {
                id: "victoria",
                name: "Victoria",
                role: "Teacher",
                image: "assets/meetthestaffvids/victoria.jpg",
                introVideo: "assets/meetthestaffvids/victoria_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/victoria_q1.mp4" },
                    { text: "What is your favourite season?", video: "assets/meetthestaffvids/victoria_q2.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/victoria_q3.mp4" }
                ]
            },
            {
                id: "randy",
                name: "Randy",
                role: "Teacher",
                image: "assets/meetthestaffvids/randy.jpg",
                introVideo: "assets/meetthestaffvids/randy_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/randy_q1.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/randy_q2.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/randy_q3.mp4" }
                ]
            },
            {
                id: "felicity",
                name: "Felicity",
                role: "Attendant",
                image: "assets/meetthestaffvids/felicity.png",
                introVideo: "assets/meetthestaffvids/felicity_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/felicity_q1.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/felicity_q2.mp4" },
                    { text: "What can we do in the evenings?", video: "assets/meetthestaffvids/felicity_q3.mp4" }
                ]
            },
            {
                id: "yuko",
                name: "Yuko",
                role: "Attendant",
                image: "assets/meetthestaffvids/yuko.jpg",
                introVideo: "assets/meetthestaffvids/yuko_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/yuko_q1.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/yuko_q2.mp4" },
                    { text: "How did you learn English?", video: "assets/meetthestaffvids/yuko_q3.mp4" }
                ]
            },
            {
                id: "mizuki",
                name: "Mizuki",
                role: "Attendant",
                image: "assets/meetthestaffvids/mizuki.png",
                introVideo: "assets/meetthestaffvids/mizuki_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/mizuki_q1.mp4" },
                    { text: "What is your favorite season here?", video: "assets/meetthestaffvids/mizuki_q2.mp4" },
                    { text: "What is a fun lesson at British Hills?", video: "assets/meetthestaffvids/mizuki_q3.mp4" }
                ]
            },
            {
                id: "megumi",
                name: "Megumi",
                role: "Attendant",
                image: "assets/meetthestaffvids/megumi.jpg",
                introVideo: "assets/meetthestaffvids/megumi_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/megumi_q1.mp4" },
                    { text: "What's the best souvenir to buy?", video: "assets/meetthestaffvids/megumi_q2.mp4" },
                    { text: "What is your favorite sweet?", video: "assets/meetthestaffvids/megumi_q3.mp4" }
                ]
            },
            {
                id: "moja",
                name: "Moja",
                role: "Teacher",
                image: "assets/meetthestaffvids/moja.jpg",
                introVideo: "assets/meetthestaffvids/moja_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/moja_q1.mp4" },
                    { text: "Do you like living in Japan?", video: "assets/meetthestaffvids/moja_q2.mp4" },
                    { text: "How many languages do you speak?", video: "assets/meetthestaffvids/moja_q3.mp4" }
                ]
            },
            {
                id: "emma",
                name: "Emma",
                role: "Teacher",
                image: "assets/meetthestaffvids/emma.jpg",
                introVideo: "assets/meetthestaffvids/emma_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/emma_q1.mp4" },
                    { text: "What's your favourite subject?", video: "assets/meetthestaffvids/emma_q2.mp4" },
                    { text: "What's your favourite lesson at British Hills?", video: "assets/meetthestaffvids/emma_q3.mp4" }
                ]
            },
            {
                id: "matt",
                name: "Matt",
                role: "Teacher",
                image: "assets/meetthestaffvids/matt.jpg",
                introVideo: "assets/meetthestaffvids/matt_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/matt_q1.mp4" },
                    { text: "What's your favourite TV show?", video: "assets/meetthestaffvids/matt_q2.mp4" },
                    { text: "What's your favourite lesson at British Hills?", video: "assets/meetthestaffvids/matt_q3.mp4" }
                ]
            },
            {
                id: "graham",
                name: "Graham",
                role: "Teacher",
                image: "assets/meetthestaffvids/graham.jpg",
                introVideo: "assets/meetthestaffvids/graham_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/graham_q1.mp4" },
                    { text: "What's your favourite lesson at British Hills?", video: "assets/meetthestaffvids/graham_q2.mp4" },
                    { text: "What's your favourite football team?", video: "assets/meetthestaffvids/graham_q3.mp4" }
                ]
            },
            {
                id: "shannon",
                name: "Shannon",
                role: "Teacher",
                image: "assets/meetthestaffvids/shannon.jpg",
                introVideo: "assets/meetthestaffvids/shannon_intro.mp4",
                questions: [
                    { text: "Where are you from?", video: "assets/meetthestaffvids/shannon_q1.mp4" },
                    { text: "What do you recommend at British Hills?", video: "assets/meetthestaffvids/shannon_q2.mp4" },
                    { text: "What are your hobbies?", video: "assets/meetthestaffvids/shannon_q3.mp4" }
                ]
            }
        ];

        const galleryView = document.getElementById('gallery-view');
        const staffGrid = document.getElementById('staff-grid');
        const chatView = document.getElementById('chat-view');
        const mainVideo = document.getElementById('main-video');
        const micBtn = document.getElementById('mic-btn');
        const speechFeedback = document.getElementById('speech-feedback');

        // Current Staff State for Voice Matching
        let currentStaffId = null;

        /**
         * INITIALIZE CONTACT LIST (Smartphone Style)
         */
        function initGallery() {
            staffGrid.innerHTML = '';
            
            staffData.forEach((staff, index) => {
                // Background colors for roles
                let roleBgClass = 'bg-white/60';
                
                if (staff.role === 'Teacher') roleBgClass = 'bg-yellow-50/70';
                if (staff.role === 'Attendant') roleBgClass = 'bg-rose-50/70';
                if (staff.role === 'Guest Services') roleBgClass = 'bg-blue-50/70';

                const row = document.createElement('div');
                row.className = `contact-row ${roleBgClass} border-b border-hunter/5 px-4 py-3 flex items-center justify-between cursor-pointer group`;
                row.onclick = () => openChat(staff.id);

                // Initial/Avatar logic
                const initials = staff.name.charAt(0).toUpperCase();
                
                row.innerHTML = `
                    <div class="flex items-center gap-4">
                        <!-- Round Avatar -->
                        <div class="w-12 h-12 md:w-14 md:h-14 rounded-full overflow-hidden border-2 border-gold/30 shrink-0 bg-hunter flex items-center justify-center">
                            <img 
                                src="${staff.image}" 
                                alt="${staff.name}" 
                                class="w-full h-full object-cover"
                                onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                            >
                            <span class="hidden text-cream font-header font-bold text-xl">${initials}</span>
                        </div>
                        
                        <!-- Name & Role -->
                        <div class="flex flex-col">
                            <span class="text-xl md:text-2xl font-header font-bold text-hunter leading-tight">
                                ${staff.name}
                            </span>
                            <span class="text-sm font-accent text-gold-dark opacity-80 uppercase tracking-widest">
                                ${staff.role}
                            </span>
                        </div>
                    </div>

                    <!-- Call Icon -->
                    <div class="call-btn flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-hunter/5 group-hover:bg-hunter transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-hunter group-hover:text-cream transition-all" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                        </svg>
                    </div>
                `;
                staffGrid.appendChild(row);
            });
        }

        /**
         * CHAT UI LOGIC
         */
        function openChat(staffId) {
            const staff = staffData.find(s => s.id === staffId);
            if (!staff) return;

            currentStaffId = staffId; // Set current staff for voice logic

            document.getElementById('chat-staff-name').textContent = staff.name;
            document.getElementById('chat-staff-role').textContent = staff.role;

            const questionContainer = document.getElementById('question-buttons');
            questionContainer.innerHTML = '';

            playVideo(staff.introVideo);

            staff.questions.forEach((q, index) => {
                const btn = document.createElement('button');
                btn.id = `q-btn-${index}`; // Add ID for voice triggering
                btn.className = "text-left bg-white border-2 border-hunter/20 p-3 md:p-4 rounded-lg shadow-sm hover:border-gold hover:shadow-md hover:bg-cream transition-all group w-full";
                btn.innerHTML = `
                    <span class="block font-header font-bold text-hunter text-xs md:text-sm mb-1 group-hover:text-gold-dark">Question ${index + 1}</span>
                    <span class="font-body text-lg md:text-xl leading-tight">${q.text}</span>
                `;
                btn.onclick = () => {
                    // Reset styling on all buttons
                    Array.from(questionContainer.children).forEach(b => {
                        b.classList.remove('border-gold', 'bg-cream');
                        b.classList.add('border-hunter/20', 'bg-white');
                    });
                    // Highlight active button
                    btn.classList.remove('border-hunter/20', 'bg-white');
                    btn.classList.add('border-gold', 'bg-cream');
                    
                    playVideo(q.video);
                };
                questionContainer.appendChild(btn);
            });

            galleryView.classList.add('opacity-0');
            setTimeout(() => {
                galleryView.classList.add('hidden');
                chatView.classList.remove('hidden');
            }, 300);
        }

        function closeChat() {
            mainVideo.pause();
            mainVideo.currentTime = 0;
            mainVideo.src = "";
            currentStaffId = null; // Clear state

            chatView.classList.add('hidden');
            galleryView.classList.remove('hidden');
            setTimeout(() => {
                galleryView.classList.remove('opacity-0');
            }, 50);
        }

        function playVideo(src) {
            mainVideo.src = src;
            mainVideo.load();
            const playPromise = mainVideo.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {}).catch(error => {
                    console.log("Video status: " + error);
                });
            }
        }

        /**
         * VOICE RECOGNITION LOGIC
         */
        // Check for browser support
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        
        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.lang = 'en-US';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            micBtn.onclick = () => {
                recognition.start();
                micBtn.classList.add('mic-listening');
                speechFeedback.textContent = "Listening...";
                speechFeedback.style.color = "#c5a009"; // Gold
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                speechFeedback.textContent = `I heard: "${transcript}"`;
                speechFeedback.style.color = "#234f32"; // Hunter Green
                
                micBtn.classList.remove('mic-listening');
                
                handleVoiceCommand(transcript);
            };

            recognition.onspeechend = () => {
                recognition.stop();
                micBtn.classList.remove('mic-listening');
            };

            recognition.onerror = (event) => {
                micBtn.classList.remove('mic-listening');
                speechFeedback.textContent = "Error occurred in recognition: " + event.error;
                speechFeedback.style.color = "#ef4444"; // Danger Red
            };
        } else {
            micBtn.style.display = 'none';
            speechFeedback.textContent = "Voice not supported on this browser.";
        }

        function handleVoiceCommand(transcript) {
            if (!currentStaffId) return;

            const staff = staffData.find(s => s.id === currentStaffId);
            if (!staff) return;

            // Simple Keyword Matching Strategy
            // We define "unique" keywords for each question type to ensure accuracy
            let bestMatchIndex = -1;
            let highestScore = 0;

            const stopWords = ['what', 'where', 'do', 'you', 'is', 'are', 'the', 'a', 'an', 'to', 'of', 'in', 'your', 'my', 'i', 'please', 'tell', 'me'];

            staff.questions.forEach((q, index) => {
                const questionWords = q.text.toLowerCase().replace(/[?.,]/g, '').split(' ');
                const spokenWords = transcript.replace(/[?.,]/g, '').split(' ');
                
                let score = 0;

                spokenWords.forEach(word => {
                    if (stopWords.includes(word)) return; // Skip stop words
                    if (questionWords.includes(word)) {
                        score += 1;
                    }
                });

                // Boost score for specific strong keywords
                if (transcript.includes('from') && q.text.toLowerCase().includes('from')) score += 2;
                if (transcript.includes('recommend') && q.text.toLowerCase().includes('recommend')) score += 2;
                if (transcript.includes('food') && q.text.toLowerCase().includes('food')) score += 2;
                if (transcript.includes('hobby') || transcript.includes('hobbies') && q.text.toLowerCase().includes('hobbies')) score += 2;
                if (transcript.includes('football') && q.text.toLowerCase().includes('football')) score += 2;
                if (transcript.includes('lesson') && q.text.toLowerCase().includes('lesson')) score += 2;
                if (transcript.includes('season') && q.text.toLowerCase().includes('season')) score += 2;
                if (transcript.includes('help') && q.text.toLowerCase().includes('help')) score += 2;
                if (transcript.includes('english') && q.text.toLowerCase().includes('english')) score += 2;

                if (score > highestScore) {
                    highestScore = score;
                    bestMatchIndex = index;
                }
            });

            // Threshold: Must have at least a decent match score
            if (highestScore >= 1 && bestMatchIndex !== -1) {
                // Programmatically click the button to trigger video & UI updates
                const btnToClick = document.getElementById(`q-btn-${bestMatchIndex}`);
                if (btnToClick) btnToClick.click();
            } else {
                speechFeedback.textContent = `I heard: "${transcript}" (No match found)`;
                speechFeedback.style.color = "#ef4444";
            }
        }

        window.addEventListener('DOMContentLoaded', initGallery);
    </script>
</body>
</html>
